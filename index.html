<html>

<head>
	<title>
		BOSM 2016 | GRIT GUT GLORY | BITS Pilani
	</title>
	<link rel="stylesheet" href="./css/style.css">
	<script src="./js/jquery.min.js"></script>
	<script type="text/javascript" src="./js/phaser.min.js"></script>
</head>

<body>
	<div id="nav">
	<div id="about"><p>About</p></div><!--
	--><div id="contact"><p>Contact</p></div><!--
--><div id="sponsors"><p>Sponsors</p></div>
</div>

<img id="balloon" src="./img/balloon.svg" alt="">
<div id="game">
</div>
<img id="sun" src="./img/sun.svg" alt="">
<img id="clouds" src="./img/clouds.svg" alt="">
<img id="clouds2" src="./img/clouds.svg" alt="">
<img id="timer" src="./img/timer.svg" alt="">

<script>
$("#sun").animate({
		top: '10%'
	},1200);
$("#balloon").delay(500).animate({
		top: '30%'
	},1200);
$("#clouds").animate({
	left:'100vw'
},20000);
$("#clouds2").animate({
	left:'100vw'
},15000);
function cloudanimate() {
	$("#clouds").animate({
	left:'100vw'
	},20000);
}


function cloudanimate2() {
	$("#clouds2").animate({
	left:'100vw'
},15000);
}
/*setInterval(function(){
	$("#clouds").css({'left','0'});
},20000);*/
var cloudsjs=document.getElementById('clouds');

$(function(){
	setInterval(function(){
	if(cloudsjs.style.left=='100vw'){
		cloudsjs.style.left='-5vw';
		cloudanimate();
	}
	if(cloudsjs.style.left=='100vw'){
		cloudsjs.style.left='-5vw';
		cloudanimate();
	}
},1000);

});


	/*---------------GAME------------------*/

	var game = new Phaser.Game(window.innerWidth, 450, Phaser.AUTO, 'game', { preload: preload, create: create, update: update });

	function preload() {

    game.load.image('ground', './img/ground.svg');
    game.load.image('shuttleMountain','./img/shuttle_mountain.svg');
    game.load.image('waterBuilding','./img/water_building.svg');
    game.load.image('coconutBuilding','./img/coconut_building.svg');
    game.load.image('bottleBuilding','./img/bottle_building.svg');
    game.load.image('mineralBuilding','./img/mineral_building.svg');
    game.load.image('clouds','./img/clouds.svg');
   	// game.load.image('sky', './img/sky.svg');
   	
    game.load.image('hurdleImg','./img/hurdlex.png');
    // game.load.spritesheet('dude', 'assets/dude.png', 32, 48);*/
    game.load.spritesheet('dude','./img/seq.png',216,318);
	}

	var platforms;
	var graphics;
	var cursors;
	var player;
	var man;
	var ground;
	var hudrles;
	var score=0;
	var scoreText;
	var hurdle;
	var shuttleMountain;
	var waterBuilding;
	var coconutBuilding;
	var bottleBuilding,mineralBuilding,clouds;
	function create() {
		game.stage.backgroundColor = '#8ECDD2;';
		 //  We're going to be using physics, so enable the Arcade Physics system
    game.physics.startSystem(Phaser.Physics.ARCADE);

    //  A simple background for our game
    // game.add.sprite(0, 0, 'sky');


    graphics = game.add.group();

	 graphics.enableBody=true;
	 shuttleMountain = graphics.create(80,160,'shuttleMountain');
	 shuttleMountain.scale.setTo(0.4,0.4);
	 coconutBuilding=graphics.create(550,120,'coconutBuilding');
	 coconutBuilding.scale.setTo(0.8,0.8);
	 bottleBuilding=graphics.create(800,90,'bottleBuilding');
	 mineralBuilding=graphics.create(1000,60,'mineralBuilding');

	 bottleBuilding.scale.setTo(0.5,0.5);

	 clouds=graphics.create(0,10,'clouds');
	 clouds.scale.setTo(0.6,0.6);
	 waterBuilding =graphics.create(300,80,'waterBuilding');
	 waterBuilding.scale.setTo(0.5,0.5);


    //  The platforms group contains the ground and the 2 ledges we can jump on
    platforms = game.add.group();

    //  We will enable physics for any object that is created in this group
    platforms.enableBody = true;

    // Here we create the ground.
    
       // waterBuilding= game.add.sprite()
	ground = platforms.create(0,game.world.height-230,'ground');


    //  Scale it to fit the width of the game (the original sprite is 400x32 in size)
    ground.scale.setTo(0.7, 0.7);

    //  This stops it from falling away when you jump on it
    ground.body.immovable = true;

    

    hurdles=game.add.group();
    hurdles.enableBody=true;

    hurdle=hurdles.create(game.world.width,game.world.height - 100,'hurdleImg');
 	hurdle.enableBody=true;
    // hurdle.body.collideWorldBounds=true;
    // hurdle.scale.setTo(0.2,0.2);

    setInterval(function(){
    	
    	hurdle=hurdles.create(game.world.width+game.world.randomX,game.world.height - 100,'hurdleImg');
    	score++;
    	hurdle.enableBody=true;
    	// hurdle.body.collideWorldBounds=true;
    // hurdle.scale.setTo(0.2,0.2);
	},2000);


   	setInterval(function(){
   		clouds=graphics.create(0-game.world.randomX,10*(1+Math.random()),'clouds');
   		clouds.scale.setTo(0.6,0.6);
   	},4000);

     player=game.add.sprite(200,150,'dude');
    player.scale.setTo(0.6,0.6);
     game.physics.arcade.enable(player);
     player.body.bounce.y = 0.2;
    player.body.gravity.y = 1000;
    player.body.collideWorldBounds = true;

    player.animations.add('walk',[0,1,2,3,4,5,6,7,8,9],10,true);
    // player.animations.play('walk');
        scoreText = game.add.text(100, 100, 'Score: 0', { fontSize: '32px', fill: '#fff' });

     //  Our controls.
    cursors = game.input.keyboard.createCursorKeys();

	}

	function update() {
		console.log(Math.floor(game.time.totalElapsedSeconds()));
		scoreText.text = 'Score: ' + Math.floor(game.time.totalElapsedSeconds());
		hurdle.body.velocity.x=-350;
		clouds.body.velocity.x=30;

    // //  Collide the player and the stars with the platforms
    // game.physics.arcade.collide(player, platforms);
 player.animations.play('walk');



    game.physics.arcade.overlap(player, hurdles, collision, null, this);
     //  Reset the players velocity (movement)
    player.body.velocity.x = 0;

    // game.physics.arcade.collide(player, hurdles);

    if (cursors.left.isDown)
    {
        //  Move to the left
        player.body.velocity.x = -250;

        
    }
    else if (cursors.right.isDown)
    {
        //  Move to the right
        player.body.velocity.x = 250;

       
    }
    else
    {
        //  Stand still
        player.animations.stop();

        player.frame = 4;
    }

    // console.log(cursors.up.isDown ,player.body.y,game.world.height);
    //  Allow the player to jump if they are touching the ground.
    if (cursors.up.isDown && player.body.y>250)
    {
        player.body.velocity.y = -800;
    }

    function collision(player,hurdle) {
    	

    
    	player.body.velocity.x = 0;
    	hurdle.body.velocity.x= 0;
    	hurdles.body.velocity.x=0;
    	clouds.body.velocity.x=100;
    	 // score += 10;
    	 
    }

}

console.log($("#game").children().children());
</script>
</body>

</html>